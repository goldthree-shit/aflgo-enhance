diff --git a/src/isomedia/box_code_drm.c b/src/isomedia/box_code_drm.c
index 257739234..cd3295fae 100644
--- a/src/isomedia/box_code_drm.c
+++ b/src/isomedia/box_code_drm.c
@@ -1375,7 +1375,7 @@ GF_Err senc_Parse(GF_BitStream *bs, GF_TrackBox *trak, void *traf, GF_SampleEncr
 				for (j = 0; j < sai->subsample_count; j++) {
 					if (gf_bs_get_size(bs) - gf_bs_get_position(bs) < 6) {
 						gf_isom_cenc_samp_aux_info_del(sai);
-						if (trak->moov->mov->FragmentsFlags & GF_ISOM_FRAG_READ_DEBUG) {
+						if (trak && trak->moov && trak->moov->mov && trak->moov->mov->FragmentsFlags & GF_ISOM_FRAG_READ_DEBUG) {
 							gf_bs_seek(bs, pos);
 							GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER, ("[isobmf] Failed to parse SENC box, invalid SAI size\n" ));
 							return GF_OK;
