diff --git a/src/isomedia/box_code_apple.c b/src/isomedia/box_code_apple.c
index 73a8c438a..f332b8519 100644
--- a/src/isomedia/box_code_apple.c
+++ b/src/isomedia/box_code_apple.c
@@ -116,10 +116,11 @@ GF_Err ilst_item_Read(GF_Box *s,GF_BitStream *bs)
 	if (sub_type == GF_ISOM_BOX_TYPE_DATA ) {
 		e = gf_isom_box_parse(&a, bs);
 
-		if (!e && ptr->size < a->size) {
+		if (!e && a && ptr->size < a->size) {
 			GF_LOG(GF_LOG_ERROR, GF_LOG_CONTAINER, ("[isom] not enough bytes in box %s: %d left, reading %d (file %s, line %d)\n", gf_4cc_to_str(ptr->type), ptr->size, a->size, __FILE__, __LINE__ )); \
 			e = GF_ISOM_INVALID_FILE;
 		}
+		if (!a) e = GF_ISOM_INVALID_FILE;
 		if (e) {
 			if (a) gf_isom_box_del(a);
 			return e;
